{"abstractText": "One of the most important components of an ecological community is its food web. Early models of population dynamics generally only considered interactions between two species (e.g., Canale1; Rosenzweig andMacArthur2). However, in nature, food webs wherein only two species influence the behaviour of the network are quite uncommon \u2013 most networks are far more complex [3]. Therefore, several researchers asserted that every food web study should involve at least three species in order to capture that com\u2010 plexity [4, 5]. At first, the core interest of food web research was in equilibrium analysis, partly based on the assumption that communities observed in nature represent a stable equilibrium state [6]. However, complex dynamics arise in a system with three or more species, and these are better described as chaos rather than stable equilibrium. The simplest defini\u2010 tion of chaos is the extreme sensitivity of a system to its initial conditions [6]. Hastings and Powell3, who studied chaos in a continuous\u2010time model of a food web including three species, contributed considerably to the significance and understanding of this subject. This study led to many others on food webs dynamics and chaos, which rein\u2010 forced the importance of chaos in ecological modelling [7, 8]. In this article, we provide a replication of themodel fromHastings and Powell3 using the same equations and parameter values. Replicating a classic study and model like this one is important for many reasons: 1) we can compare the original results with ones obtained using current technologies, ensuring that they can still be reproduced; 2) we can provide a publicly available and reproducible version of the codes that recreate the model. Wewere able to successfully replicate all figures in the original article using Julia v1.3.1. All code used to replicate the original model is available alongside this article (https://github.com/BIO6032/2019_replication_HastingsPowell_1991).", "authors": [{"affiliations": [], "name": "Gabriel Dansereau"}, {"affiliations": [], "name": "Francis Banville"}, {"affiliations": [], "name": "Elodie Basque"}, {"affiliations": [], "name": "Andrew MacDonald"}, {"affiliations": [], "name": "Timoth\u00e9e Poisot"}, {"affiliations": [], "name": "Nicolas P. Rougier"}, {"affiliations": [], "name": "Carl Boettiger"}, {"affiliations": [], "name": "Philipp Boersch-Supan"}], "id": "SP:a80ebbfba8813bb0cf35fba35faa27a4d83ec2d3", "references": [{"authors": ["R.P. Canale"], "title": "An analysis of models describing predator-prey interaction.", "venue": "en. In: Biotechnology and Bioengineering", "year": 1970}, {"authors": ["M.L. Rosenzweig", "R.H. MacArthur"], "title": "Graphical Representation and Stability Conditions of Predator-Prey Interactions.", "venue": "en. In: The American Naturalist", "year": 1963}, {"authors": ["A. Hastings", "T. Powell"], "title": "Chaos in a Three-Species Food Chain.", "venue": "en. In: Ecology", "year": 1991}, {"authors": ["P.W. Price", "C.E. Bouton", "P. Gross", "B.A. McPheron", "J.N. Thompson", "A.E. Weis"], "title": "Interactions Among Three Trophic Levels: Influence of Plants on Interactions Between Insect Herbivores and Natural Enemies.", "venue": "en. In: Annual Review of Ecology and Systematics", "year": 1980}, {"authors": ["M.L. Rosenzweig"], "title": "Exploitation in Three Trophic Levels.", "venue": "en. In: The American Naturalist", "year": 1973}, {"authors": ["A. Hastings", "C.L. Hom", "S. Ellner", "P. Turchin", "H.C.J. Godfray"], "title": "Chaos in Ecology: Is Mother Nature a Strange Attractor?", "venue": "Annual Review of Ecology and Systematics", "year": 1993}, {"authors": ["B. Blasius", "A. Huppert", "L. Stone"], "title": "Complex dynamics and phase synchronization in spatially extended ecological systems.", "venue": "en. In: Nature 399.6734", "year": 1999}, {"authors": ["S. Gakkhar", "A. Singh"], "title": "Control of chaos due to additional predator in the Hastings\u2013Powell food chain model.", "venue": "en. In: Journal of Mathematical Analysis and Applications", "year": 2012}, {"authors": ["J. Bezanson", "A. Edelman", "S. Karpinski", "V.B. Shah"], "title": "Julia: A Fresh Approach to Numerical Computing.", "venue": "en. In: SIAM Review", "year": 2017}], "sections": [{"text": "R E S C I E N C E C Replication / ecology\n[Re] Chaos in a Three-Species Food Chain\nGabriel Dansereau1, ID , Francis Banville1, ID , Elodie Basque1, ID , Andrew MacDonald1, ID , and Timoth\u00e9e Poisot1, ID 1Universit\u00e9 de Montr\u00e9al, Montr\u00e9al, Canada\nEdited by Nicolas P. Rougier ID\nReviewed by Carl Boettiger ID\nPhilipp Boersch-Supan ID\nReceived 07 February 2020\nPublished 10 September 2020\nDOI 10.5281/zenodo.4022518\n1 Introduction\nOne of the most important components of an ecological community is its food web. Early models of population dynamics generally only considered interactions between two species (e.g., Canale1; Rosenzweig andMacArthur2). However, in nature, food webs wherein only two species influence the behaviour of the network are quite uncommon \u2013 most networks are far more complex [3]. Therefore, several researchers asserted that every food web study should involve at least three species in order to capture that com\u2010 plexity [4, 5]. At first, the core interest of food web research was in equilibrium analysis, partly based on the assumption that communities observed in nature represent a stable equilibrium state [6]. However, complex dynamics arise in a system with three or more species, and these are better described as chaos rather than stable equilibrium. The simplest defini\u2010 tion of chaos is the extreme sensitivity of a system to its initial conditions [6]. Hastings and Powell3, who studied chaos in a continuous\u2010time model of a food web including three species, contributed considerably to the significance and understanding of this subject. This study led to many others on food webs dynamics and chaos, which rein\u2010 forced the importance of chaos in ecological modelling [7, 8]. In this article, we provide a replication of themodel fromHastings and Powell3 using the same equations and parameter values. Replicating a classic study and model like this one is important for many reasons: 1) we can compare the original results with ones obtained using current technologies, ensuring that they can still be reproduced; 2) we can provide a publicly available and reproducible version of the codes that recreate the model. Wewere able to successfully replicate all figures in the original article using Julia v1.3.1. All code used to replicate the original model is available alongside this article (https://github.com/BIO6032/2019_replication_HastingsPowell_1991).\n2 Methods\nThe model formulation used in this paper is the same as in the original publication. Hastings and Powell used a continuous\u2010time model with 14 parameters to represent the three\u2010species food chain, with X, Y , and Z as the numbers of the species at the lowest level of the food chain, of the species that preys upon X, and of the species that preys upon Y , respectively. However, all of their analyses are based on a simpler version of the model with nondimensional measures of time and population sizes, hence 10 pa\u2010 rameters only, with x, y and z as the standardized abundances of the three species. We\nCopyright \u00a9 2020 G. Dansereau et al., released under a Creative Commons Attribution 4.0 International license. Correspondence should be addressed to Gabriel Dansereau (gabriel.dansereau@umontreal.ca) The authors have declared that no competing interests exists. Code is available at https://github.com/BIO6032/2019_replication_HastingsPowell_1991/ \u2013 DOI 10.5281/zenodo.4012772. Open peer review is available at https://github.com/ReScience/submissions/issues/15.\nReScience C 6.3 (#5) \u2013 Dansereau et al. 2020 1\nchose to present this simpler nondimensional version only in this paper, and we invite readers to consult Hastings and Powell\u2019s paper for more details on the original dimen\u2010 sional parameters. Our model\u2019s formulation is given as:\ndx/dt = x(1\u2212 x)\u2212 f1(x)y dy/dt = f1(x)y \u2212 f2(y)z \u2212 d1y dz/dt = f2(y)z \u2212 d2z\n(1)\nwith\nfi(u) = aiu/(1 + biu) (2)\nas the functional response. Parameter values used in this paper are the same as in the original paper (Table 1). How\u2010 ever, initial conditions of the simulations (i.e. the values of x, y and z at the start) were not given in the original paper. This is an important point, as initial conditions strongly affect the simulations, particularly in the context of chaotic behaviour. We knew from Fig.3 of the original paper that x \u2248 0.76. We tried to approximate y and z by trial and error, and found x = 0.76, y = 0.16 and z = 9.9 to be an appropriate combination for most cases. We adapted the initial conditions in some simulations to give the closest matching graphical result to the original figures. The conditions used are specified in each figure caption. We consider this a successful replication, despite the impossibility of using precisely the same initial conditions.\nAs noted by Hastings and Powell, numerical integration is the only way to investigate the global dynamical behaviour of the system. We used Julia v1.3.1 [9], along with pack\u2010 ages DifferentialEquations.jl [10] to compute the numerical integrations and Plots.jl to represent our results. Not knowing the exact algorithm used in the orig\u2010 inal article, we let the solve() function select the appropriate algorithm to solve our differential equations. In our implementation, it selected a composite algorithm com\u2010 bining, amongst others, algorithms Tsit5 and Rosenbrock23. We did note, however, that setting a specific algorithm such as RK4 sometimes resulted in a similar behaviour for the system. To fully replicate key findings of the original paper, we focused on replicating original figures. Here we describe the steps we took for Fig. 2, 3, 4 and 5 from the original paper. Note that Fig. 5A refers to Hastings and Powell\u2019s figure, while Figure 5a refers to our reproduction. Original Fig. 2 illustrates the chaotic behaviour of the system in time for each species. In order to replicate it, we followedHastings and Powell\u2019smethod and let our system run for 10 000 time steps. We then represented the system\u2019s behaviour by plotting the species nondimensional variables against time (between time steps 5000 and 6500, which elimi\u2010 nates transient behaviour), as well as a three\u2010dimensional phase plot of the three species (for all time steps). Note that in the case of the three\u2010dimensional phase plot, we had to set RK4 as the solving algorithm, as well as a relative tolerance of 1e\u2212 14; otherwise, the representation was unexpectedly different from the original paper. This suggests\nReScience C 6.3 (#5) \u2013 Dansereau et al. 2020 2\nthat the results for this figure in the original article may have been an artifact. In or\u2010 der to illustrate the dynamics of the model, we created a Graphics Interchange Format (GIF) file of the three\u2010dimensional phase plot that showed the trajectories of x, y and z for the selected parameters (https://github.com/BIO6032/2019_replication_HastingsPowell_1991/ blob/master/article/figures/figure2D.gif). Original Fig. 3 shows the divergence of trajectories caused by a small change in initial conditions when the system exhibits chaotic behaviour. To replicate the figure, we plot\u2010 ted the trajectory for species x between time steps 0 and 500 starting at x = 0.77, then changed the initial x value by 0.01 (to x = 0.78) and plotted the new trajectory for the same interval on the same figure. Original Fig. 4 illustrates the appearance of chaotic behaviour as a function of changes in b1. To replicate it, we constructed a bifurcation diagram for species z where we varied values of b1 from 2.2 to 6.2 in steps of 0.01. However, our approach was slightly differ\u2010 ent from the original one. Hastings and Powell\u2019s figure is a special type of bifurcation diagram representing only the maxima of z as a function of b1, rather than all possi\u2010 ble values in the system\u2019s behaviour as in a typical logistic bifurcation diagram. This raises the problem of correctly identifying the maximum values in the cycling dynam\u2010 ics. Moreover, Hastings and Powell mention removing points resulting from secondary local maxima, but do not provide details on how to identify these points. Hence, we adopted the following method: 1) we let the system run for continuous time steps be\u2010 tween 0 and 10 000, then kept the last 1000 solutions to the numerical integration to eliminate transient behaviour (note that these do not occur at time steps between 9000 and 10 000, as the system doesn\u2019t necessarily reach a stable solution, and that the exact time steps vary for all values of b1); 2) we selected the values of z that were greater than both their preceding and following values, which identified local maxima only; and 3) we only kept values that were greater than a given threshold of the cycle\u2019s maximal am\u2010 plitude, in order to remove secondary local maxima. We determined by trial and error that the best threshold was 66%, as it best removed values in apparent second branches of b1 while keeping the values in the primary branch. We note however that for some values of b1, the true solutions of the system were unstable and that the system did not reach a cycling behaviour within 10 000 steps. For these values of b1 (37 values, all be\u2010 tween 5.01 and 6.2), we could not present any values of z in our bifurcation diagram. Hastings and Powell mention in their original paper that they also examined the sys\u2010 tem\u2019s behaviour when varying b2 instead of b1, although they do not present the results. We examined the same behaviour by constructing another bifurcation diagram of z for values of b2 varying from 1.5 to 3.2, using the same method as described above. We set b1 = 3.0, as it is the example used to illustrate chaotic behaviour throughout Hastings and Powell\u2019s paper. Original Fig. 5 illustrates another diagnostic feature of chaos, slopes of high magnitude on a Poincar\u00e9 map, for values of b1 where the bifurcation diagram suggests chaotic be\u2010 haviour. In order to replicate this figure, we solved the system of differential equations using the abovementioned algorithm RK4, as well as a relative tolerance of 1e\u2212 14. We used b1 = 3.0 and b1 = 6.0, as in the original paper, to replicate its subfigures A\u2010B and C\u2010 D, respectively. We defined planes of equation z = 9.0 and z = 3.0 for those subfigures, respectively, as these intercepted the \u201dhandles\u201d of their respective three\u2010dimensional phase plot. We defined those \u201dhandles\u201d as in Hastings and Powell, that is as the region in the phase plots where z declines from its maxima to its minima. However, we had to use a tolerance value \u03f5 = 0.05 in order to identify the points whose distance from the plane was negligible (i.e. their z values ranging between 8.95\u20109.05 and 2.95\u20103.05, re\u2010 spectively), since we were not able to find the phase plots\u2019 exact interception points. We specified the planes\u2019 x and y coordinates to retain only the points that were in the \u201dhan\u2010 dles\u201d (subfigures A,B: x and y ranging between 0.95\u20100.98 and 0.015\u20100.040, respectively; subfigures C,D: x and y ranging between 0.93\u20101.00 and 0.00\u20100.09, respectively). As in the original paper, we recreated the Poincar\u00e9 sections (subfigures A,C), by plotting y against x coordinates of the retained points, and the Poincar\u00e9maps (subfigures B,D), by plotting\nReScience C 6.3 (#5) \u2013 Dansereau et al. 2020 3\nx coordinates of the retained points x(n) against that of their immediate subsequent re\u2010 tained points x(n+ 1). Since Hastings and Powell\u2019s Fig. 5E only schematized the plane in the three\u2010dimensional phase plot, we did not reproduce it. The objective of this paper being to reproduce the main results of the original paper, we did not reproduce its Fig. 1, which was only a schematic representation of the three\u2010 species food chain.\n3 Results\nWe were able to replicate Hastings and Powell\u2019s main findings, even without knowing their exact algorithm and initial values. First, our time series of the nondimensional variables (Figure 1) presents similar qualitative results as those identified by Hastings and Powell. We observed that the standardized population densities of x, y, and z (Equa\u2010 tion 1, Equation 2) oscillate with a period of around 125 time steps. Within a cycle, the population densities of species x and y oscillate while that of species z grows until it reaches its primary local maximum (see definition in methods), at which y and x re\u2010 spectively reach their local minimum and maximum values. z then declines until it reaches its local minimum, forming the \u201dhandle\u201d of the teacup (Figure 2), and subse\u2010 quently beginning a new cycle. The animated figure we produced illustrates this dy\u2010 namic (see supp. online material). Although slight discrepancies exist between our results and those of Hastings and Powell, they did not seem to strongly influence the abovementioned period length, nor the values of the local maxima and minima of the dimensionless variables. Indeed, x varies approximately from 0.2 to 1.0, y from 0.0 to 0.4, and z from 7.5 to 10.5 (Figure 1), as seen in the original paper. Second, the time series of x from t = 0 to 500 supports the chaotic behaviour of the system, with slightly different initial conditions leading to increasingly different trajec\u2010 tories (Figure 3). The values themselves are almost identical to Hastings and Powell\u2019s until t \u2248 250, at which point they start to diverge, but this behaviour was to be expected without the exact same initial conditions. Third, our bifurcation diagrams (Figure 4) have the same general shapes as the ones of Hastings and Powell, and are in the same range of zmax. We identified most of the local maxima of z found in the original paper for b1 ranging from 2.2 to 6.2. However, we missed some of them and we found others that were absent in their paper. For instance, for b1 = 3.1, we found multiple local maxima of z, whereas Hastings and Powell had only found a dichotomy of values. The differences are even more apparent in Figure 4c, which represents a detailed portion of Figure 4a. For example, contrary to their findings, we did identify local maxima values for b1 ranging from 2.30 and 2.35. In other words, we did not observe the significant gap in the bifurcation diagram that they had found. Our additional bifurcation diagrams, wherewe varied b2 instead of b1 (Figure 6), confirm that chaos occurs for values other than b2 = 2.0. Chaos is apparent for both smaller or greater values. However, while Hastings and Powell reported that chaos wasmore likely for greater values of b2, our results highlight that z instead converges to a single value and starts to rapidly approach zero past b2 = 2.35. Lastly, although Hastings and Powell did not specify the equation of the plane that crosses the trajectories of the phase plot at its \u201dhandle\u201d, we were able to accurately repli\u2010 cate their Poincar\u00e9 section andmap for b1 = 3.0 (Figure 6 a,b). Themain discordance lies in the number of points that cross the plane, and consequently on the apparent smooth\u2010 ness of the plots. On the other hand, it was harder to precisely replicate the Poincar\u00e9 map for b1 = 6.0 (Figure 6d), even though the corresponding reproduced Poincar\u00e9 section (Figure 6c) was similar to the one in Hastings and Powell\u2019s paper.\nReScience C 6.3 (#5) \u2013 Dansereau et al. 2020 4\n4 Discussion\nWewere able to replicate the chaotic behaviour displayedbyHastings andPowell\u2019smodel. The resulting behaviour is indeed very sensitive to the initial conditions, showing in\u2010 creasingly diverging trajectories (Figure 3) for slightly different parameters, as well as unending oscillations (Figure 1). The bifurcation diagrams (Figure 4) further confirm the existence of chaos by illustrating the presence of cyclic behaviour for some values and chaotic intervals for others, hence the extreme sensitivity of the system to b1 values. As for the Poincar\u00e9 sections (Figure 6 a,c), Hastings and Powell plotted (x,y) coordinates of points of the phase plots that theoretically coincided with the plane in the \u201dhandle\u201d of the teacup\u2010shaped diagrams. The Poincar\u00e9 sections being almost unidimensional, we considered, as explained in the original paper, a single variable within our Poincar\u00e9 maps (Figure 6 b,d). The slopes of these latter graphs therefore also denoted chaos, as specified by Hastings and Powell. For Figure 1 and Figure 3, the shape of the cycles and oscillations are similar to Hastings andPowell\u2019s. Asmentioned earlier, the slight differences are due to the fact thatwe could not use the exact same initial conditions as the original authors. Such difference is to be expected with a system exhibiting chaotic behaviour and do not alter the conclusions. The difference between our Figure 4 and Hastings and Powell\u2019s bifurcation diagram is more intriguing. Admittedly, we could not figure out exactly what Hastings and Pow\u2010 ell\u2019s method was, and some elements such as identifying maxima values by increasing b1 first, then by decreasing it, did not make sense to us. Ourmethod should be appropri\u2010 ate, theoretically, to select only values that are primary local maxima, and it did seem to work very well for most b2 values; yet, the broad range of values that we observed at b1 = 3.1 instead of a dichotomy is hard to explain. It seems unlikely that the problem could be related to our arbitrary threshold of 66% or to our identification of a local max\u2010 imum, because we would then either miss some lower values or have too many, not having more in between. The timeseries of all values of z (not presented here) for b1 = 3.1 confirms that there are \u201dintermediate\u201d maxima values, which should be selected by any proper method. We suggest that the difference might be due to the algorithms used for the numerical integration in our two studies. It is possible that the relation\u2010 ship between the parameters at this point is such that a small difference in algorithm might have an important impact. It is also possible that their algorithm came up with an unstable solution and a system that did not reach cycling behaviour, such as ours for certain values past b1 = 5.01, but that Hastings and Powell\u2019s method selected some values anyways, explaining the behaviour at b1 = 3.1. While we also found chaos for values of b2 other than the default one of 2.0, both smaller or greater, we do not totally agree with Hastings and Powell that \u201dchaos is more likely for larger values of b2\u201d. As Figure 6 shows, chaos canbe quite likely for both smaller or larger values. We find important to note, however, that at a certain value of b2, z converges and starts to crash, thus exhibiting non\u2010chaotic behaviour within a given range of b1 values. This crash is to be expectedwhen looking at the original dimensional parameters, so it is possible that Hastings and Powell simply chose not to reach this limit in their analyses, as they were only interested in biologically reasonable parameters likely to occur with the three species present. We believe that our mixed results in attempting to replicate Figure 6 came from the algorithm we used to identify the points that coincided with the plane. For instance, we had to specify a tolerance value (\u03f5 = 0.05), which defined a region under and above the plane. Although we were able to precisely replicate the Poincar\u00e9 sections for b1 = 3.0 (Figure 6a) and 6.0 (Figure 6c), the Poincar\u00e9 maps need some refinement. For b1 = 3.0 (Figure 6b), it lacked some points of the phase plots and included others that were closed yet non\u2010coincident with the plane. For b1 = 6.0 (Figure 6d), the discrepancy was more obvious, andmight be due to the more chaotic behaviour of the system under this parameter value, observed for example from the larger width of its \u201dhandle\u201d (compare\nReScience C 6.3 (#5) \u2013 Dansereau et al. 2020 5\naxis intervals of Figure 6 a,c). We have succeeded in replicating Hastings and Powell\u2019s model and its main findings, as our results confirm chaos arising in a three\u2010species food chain in continuous time. In general, the model, including its equations and parameters, was well described by the authors. Themost significant obstacles to reproducibility inHastings and Powell\u2019s paper were the absence of the values of the initial conditions, which have a huge impact on a chaotic system, and the insufficient description of the numerical integration methods. Consequently, there are slight differences between our results and theirs. Furthermore, since we tried to keep our implementation as close as possible to the original one, some steps did rely on arbitrary thresholds (for instance for the primary local maxima or the boundaries of the Poincar\u00e9 sections and maps). Hence, our replication is somewhat inflexible and possibly could not be applied to a broader range of parameter values. We suggest that an interesting step forward would be to train machine\u2010learning algorithms, such as neural networks, to identify chaotic behaviour and its boundaries, in order to obtain an even better performing implementation.\n5 Author Contributions\nGD, FB and EB performed the first version of the reproduction andwrote the first version of themanuscript. AMD and TP provided guidance and comments during the reproduc\u2010 tion, and revised the manuscript. GD performed the final revisions.\n6 Acknowledgments\nWe thank reviewers Carl Boettiger and Philipp Boersch\u2010Supan for their helpful com\u2010 ments to ensure the reproducibility of this project. This reproduction was realized as part of the BIO6032 Biologie Computationnelle etMod\u00e9lisation course at Universit\u00e9 deMon\u2010 tr\u00e9al.\nReScience C 6.3 (#5) \u2013 Dansereau et al. 2020 6"}], "title": "[Re] Chaos in a Three-Species Food Chain", "year": 2020}