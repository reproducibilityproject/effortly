{"abstractText": "DOI 10.5281/zenodo.4543356 Abstract. In 2006, during my PhD, I published my first modelling paper showing that the normal and pathological dynamics of the basal ganglia-thalamo-cortical network could be understood from a theoretical standpoint relying on a simplified model of the circuit. I recently was told by a colleague about a challenge to reproduce modelling studies over 10-years old. I was quite confident I could reproduce the results of my 2006 paper, which was based on a combination of analytical calculation and computer simulations programmed in Cwith figures produced through Matlab custom code. All the code was still saved on my computer (although in a simple but relatively messy file-and-folder organisation), and I went through my personal archives and re-run ancient code until I could provide again the results described here.", "authors": [{"affiliations": [], "name": "Arthur Leblois"}, {"affiliations": [], "name": "Beno\u00eet Girard"}], "id": "SP:7fc54fc4c972d4a14be25ef0035036f355557878", "references": [{"authors": ["R.L. Albin", "A.B. Young", "J.B. Penney"], "title": "The functional anatomy of basal ganglia disorders.", "venue": "Trends in Neurosciences", "year": 1989}, {"authors": ["M.R. DeLong"], "title": "Primate models of movement disorders of basal ganglia origin.", "venue": "Trends in Neurosciences", "year": 1990}, {"authors": ["J.P. BOLAM", "J.J. HANLEY", "P.A.C. BOOTH", "M.D. BEVAN"], "title": "Synaptic organisation of the basal ganglia.", "venue": "Journal of Anatomy 196.4", "year": 2000}, {"authors": ["M. Levesque", "A. Parent"], "title": "The striatofugal fiber system in primates: A reevaluation of its organization based on single-axon tracing studies.", "venue": "Proceedings of the National Academy of Sciences", "year": 2005}, {"authors": ["O. Aizman", "H. Brismar", "P. Uhl\u00e9n", "E. Zettergren", "A.I. Levey", "H. Forssberg", "P. Greengard", "A. Aperia"], "title": "Anatomical and physiological evidence for D1 and D2 dopamine receptor colocalization in neostriatal neurons.", "venue": "Nature Neuroscience 3.3 (Mar", "year": 2000}, {"authors": ["P. Calabresi", "D. Centonze", "G. Bernardi"], "title": "Electrophysiology of dopamine in normal and denervated striatal neurons.", "venue": "Trends in Neurosciences", "year": 2000}, {"authors": ["S.M.Nicola", "F.W.Hopf", "andG.O. Hjelmstad"], "title": "Contrast enhancement: a physiological effect of striatal dopamine?", "venue": "In: Cell and Tissue Research", "year": 2004}, {"authors": ["A. Nambu", "H. Tokuno", "I. Hamada", "H. Kita", "M. Imanishi", "T. Akazawa", "Y. Ikeuchi", "N. Hasegawa"], "title": "Excitatory Cortical Inputs to Pallidal Neurons Via the Subthalamic Nucleus in the Monkey.", "venue": "Journal of Neurophysiology", "year": 2000}, {"authors": ["H. Bergman", "T. Wichmann", "B. Karmon", "M.R. DeLong"], "title": "The primate subthalamic nucleus. II. Neuronal activity in the MPTP model of parkinsonism.", "venue": "Journal of Neurophysiology", "year": 1994}, {"authors": ["A. Raz", "E. Vaadia", "H. Bergman"], "title": "Firing Patterns and Correlations of Spontaneous Discharge of Pallidal Neurons in the Normal and the Tremulous 1-Methyl-4-Phenyl-1, 2, 3, 6-Tetrahydropyridine Vervet Model of Parkinsonism.", "venue": "The Journal of Neuroscience", "year": 2000}, {"authors": ["A. Avena-Koenigsberger", "B. Misic", "O. Sporns"], "title": "Communication dynamics in complex brain networks.", "venue": "Nature Reviews Neuroscience", "year": 2017}, {"authors": ["L. Cocchi", "L.L. Gollo", "A. Zalesky", "andM. Breakspear"], "title": "Criticality in the brain: A synthesis of neurobiology, models and cognition.", "venue": "Progress in Neurobiology", "year": 2017}, {"authors": ["A. Leblois"], "title": "Competition between Feedback Loops Underlies Normal and Pathological Dynamics in the Basal Ganglia.", "venue": "Journal of Neuroscience", "year": 2006}, {"authors": ["J. Deniau", "A. Menetrey", "S. Charpier"], "title": "The lamellar organization of the rat substantia nigra pars reticulata: Segregated patterns of striatal afferents and relationship to the topography of corticostriatal projections.", "venue": "(Aug", "year": 1996}, {"authors": ["R.M. Kelly", "P.L. Strick"], "title": "Macro-architecture of basal ganglia loops with the cerebral cortex: use of rabies virus to reveal multisynaptic circuits.", "venue": "Progress in Brain Research. Elsevier,", "year": 2004}], "sections": [{"text": "Edited by Beno\u00eet Girard ID\nReviewed by Beno\u00eet Girard ID\nID\nReceived 17 April 2020\nPublished 16 February 2021\nDOI 10.5281/zenodo.4543356"}, {"heading": "Introduction", "text": "The basal ganglia (BG) are a set of interconnected subcortical nuclei known for their implication in the pathophysiology of Parkinsons\u0313 disease (PD) as well as other movement disorders such as dystonia or Huntingtons\u0313 disease. While their function remains a matter of debate, experimental evidence suggests that the BG are involved in the selection of motor programs and drive behavioural adaptations that maximize rewarding outcome. The BG are involved in a large feedback loops with the thalamus and cortex, forming a BG-thalamo-cortical loop. Most cortical areas project to the input structures of the BG, the striatum and subthalamic nucleus (STN). These nuclei then send direct and indirect projections to the output nuclei of the BG, the internal part of the globus pallidus (GPi) and the substantia nigra pars reticulata (SNr). Efference from the GPi and SNr spontaneously exerts a tonic inhibitory influence on the targeted thalamic nuclei, themselves sending excitatory projections to frontal cortical areas, including premotor and motor cortex. Relieving this baseline inhibitory signal in the thalamus is thought to be necessary to activatemovement-related thalamo-cortical networks and execute an action. The classicalmodel for understanding howBG dysfunction leads tomotor symptoms in PD andHuntingtons\u0313 disease has been proposed by Albin and Delong1,2. It relies on a segregation between the direct and indirect pathways going from the striatum to BG output structures. It assumes that dopamine (DA) has opposing effects in these two pathways mediated through D1 and D2 receptors, respectively. In the early 2000s, several anatomical and physiological studies had questioned the segregation of the direct and indirect pathway3,4, the selective expression of D1 and D2 receptors in the striatal neurons involved in these two pathways5 and the opposite effects of dopamine through these receptors6,7. Moreover, the so-called hyperdirect pathway, which goes from the cortex to the STN and the GPi was shown to play a major role in the dynamics of the BG-thalamo-cortical network8, and was not considered at all in Albin&Delong (1989).\nCopyright \u00a9 2020 A. Leblois, released under a Creative Commons Attribution 4.0 International license. Correspondence should be addressed to Arthur Leblois (arthur.leblois@u-bordeaux.fr) The authors have declared that no competing interests exists. Code is available at https://github.com/aleblois/BGdynamics2006.\nReScience C 6.1 \u2013 Leblois 2020 1\nFinally, electrophyiological studies in human PD patients and in animal models of the disease (primates and rodents) in the 90s and 2000s had revealed strong modifications in firing patterns over the whole BG\u2013cortical network after DA depletion, with the emergence of synchronized oscillatory activity in the beta range9,10. Population dynamics of large neural networks is now known to play a crucial role in higher brain function11,12. Given the closed-loop and recurrent nature of the BG-thalamo-cortical circuit, it was difficult to understand its dynamics without referring to a mathematical model. We believed that oscillatory dynamics in large neuronal networks such as the BG-thalamocortical loop could be well predicted by simplified models of the underlying networks. Based on available anatomical, physiological and behavioural data, we designed a theoreticalmodel of the BG-thalamo-cortical loopwith a simplified connectivity pattern that did not require a segregation between the direct and indirect pathways13. Instead, our model assumed that the direct and hyperdirect pathways operate as competing feedback loops on the motor cortex14,15. The dynamics of the network was analysed mathematically and reproduced through numerical simulations. We showed that the competition between the direct and hyperdirect loops provided a natural mechanism for action selection and its loss after DA depletion, and that the imbalance between the direct and hyperdirect pathways induced pathological synchronous oscillations. Altogether, our model showed that the competition between these feedback loops of opposite polarity could be the basis for BG functions and dysfunctions."}, {"heading": "Description of the network model", "text": "The description of the network studied in the 2006 paper (Fig. 1&2 and Methods of the original article) is obvious to follow as the model is relatively simple and the number of parameters relatively limited. For the following, however, it is useful to remind the reader that our model (Fig. 1) consists in two parallel loops involved in two distinct actions (encoded in disjoint cortical populations, each enclosed in a separate BG-thalamocortical loop). Each loop consists in 2 distinct pathways from the cortical population to the GPi, one through the STN (hyperdirect pathway) and one through the striatum (direct pathway), and a feedback from GPi to cortex through a thalamic population. The two loops interact through a \u02bbcross-connection\u02bc between the STN and GPi, with relative strength \u0393 of the inter-loop connection compared to intra-loop connection."}, {"heading": "Computational context", "text": "The theoretical model developed for the 2006 paper was investigated both analytically and numerically. Of course, analytical calculations can be revived anytime, simply following the methods of the paper (in our case partly described in the appendix). The only requirement for this is to have a sufficient level in maths: in our case, the theory of linear and non-linear dynamical systems. Since I had been analysing the system 14 years ago, and althoughmymaths skills tend to be a bit rusted, I am still able to retrieve all analytical results from the original paper. The analysis consists in determining the fixed points of a dynamical system consisting in 5 neural populations, each described by a single first order threshold-linear differential equation, their stability and the types of instability that emerge (through bifurcation theory). Concerning the numerical simulations, the network activity was simulated through C-code. During my PhD, I had a \u02bbdual-boot\u02bc computer that could run Linux orWindows, for practical reasons. I was compiling my code either directly under Linux environment using gcc compiler, or under a Windows environment with Windows Visual Studio. In both cases, the results of the Ccode simulations were saved in text files where I stored the values corresponding to the activity in the various populations of the network at evenly spaced time points. Then, I relied on customMatlab code to visualize the activity of the various populations saved in\nReScience C 6.1 \u2013 Leblois 2020 2\ntext files. Indeed,Matlab is a great tool when it comes to plottingmultiple variables with many different properties, colors and style, and I had to use it anyway for the analysis of my experimental data (Pythonwas not that big at that time, especially in biology-related fields of science). For the reproduction, I relied on Code::Blocks () underWindows 10 to compile and run my old C programs, and on a recent version of Matlab (R2014b) to run my old Matlab programs."}, {"heading": "Retrieval of the software", "text": "The C-code and Matlab program used to produce the results of the 2006 article were never published or archived on-line. I simply kept them within my personal back-up. There was obviously no license for it. Running a C-program written 15 years ago is surprisingly easy. The C-language is incredibly stable, and todays compilers interpreted my old code without a single bug. Importantly, my code is written at a very basic level, and I relied on very few C libraries (the only libraries included are stdio.h, math.h, fcntl.h, and stdlib.h), making my programs very resistant to time. The motivation, at the time, was not re-usability or reproducibility or \u02bbtime-proofing .\u0313 Rather, it was motivated by the total understanding and control over the simulations (all lines of code that I was running were written by myself). Finally, my main code had little other dependencies (one header file for randomnumber generation). Running 15-years oldMatlab programs with the current version of Matlab did not cause serious trouble either. Although a few functions have changed names, the code I used to read, interpret and plot the data generated bymy C-program simulations was not using recent functions andwas very stable. I had to correct a few mistakes to retrieve the plotting function I had created then very rapidly. First, a few functions had changed names or syntax and I had to correct the command line where I called the function to make my scripts compatible with the current version of Matlab I use. Secondly, the convention on the parameters and their values given in the text were not consistent between my Matlab code and the published paper. Indeed, a late change in a convention concerning one parameter (the cross-circuit weight gamma) was not defined in the same way in the published article and in most of the work I did before. We had changed this convention very late in the writing of the paper, and I had taken no note on this parameter change. In the published paper, the\nReScience C 6.1 \u2013 Leblois 2020 3\nratio between the STN-GPi connection gain within a loop and across loops was gamma, while in the previous paper it was gamma/(1-gamma). Once this parameter change was taken into account, all results could be retrieved. Archiving all conventions used for all parameters of the model is crucial for future use. The original paper relies onnumerical simulations of twodifferent versions of themodel. One one hand, a reduced model, akin to the network which dynamics was evaluated analytically, with all-to-all connectivity between neuronal populations and no synaptic noise or heterogeneity in neuronal properties inside a given population, making all neurons from a given population equivalent. On the other hand, a detailed model, where synaptic connectionswere diluted, and neurons in each population had different thresholds (distributed normally) and received \u02bbwhite\u02bc gaussian synaptic noise. To reproduce the results of the original paper, I had to run simulations of the reduced and detailedmodels, both encoded in C-programs that I kept inmy personal archive. My directory of C-programs devoted to the simulations of the BG-thalamo-cortical network however includedmany branches, reflecting the exploration process that I had pursued in the 4 years preceding publication."}, {"heading": "Execution and reproduction of the figures", "text": "Before running simulation of the reduced or detailed model, I wanted to reproduce the phase diagram of the model, showing the results of the dynamical system analysis of the model (fixed point, stability and bifurcations). Already at that stage, numerical simulations are required since the boundaries of the stability domain for the fixed point of the system can be fully calculated by hand only in a particular case: when all pathways in the BG-thalamo-cortical feedback loops display the same total synaptic delays. However, physiological data clearly indicate that the hyperdirect and direct pathway display different synaptic delays altogether14,8. Therefore, we had to solve numerically the eigenvalue equation leading to the estimation of boundaries of the stable fixed point regime in the phase diagram (Figure 4 of the original paper, see Appendix of the original paper for the description of the equation on eigenvalues). These numerical solutions were originally computed through a dedicated Matlab routine that tool the important parameters as arguments (ratio of the time constants between the two pathways, differences in synaptic delays between the two pathways, and the relative strength \u0393 of the inter-loop connection compared to intra-loop connection, for the two loops involved in two different movements). Here, already, I encountered a first difficulty: running the Matlab code with the parameters provided in the text of the original paper did not lead to the phase diagram shown in the paper\u2026 Only after reading the code (messy and not much commented) several times that I realized there was an important comment in the program regarding the convention for the relative strength of cross-loop STN-GPi connection with respect to the intra-loop connection. Considering this change in convention, I was able to reproduce the phase diagram (Fig. 2). The most difficult part of the reproduction was to find the right version of my C-code for each figure to be reproduced. Indeed, as stated above, I explored the dynamics of the network model in many different configurations during the 4 years of my PhD, and each figure of the paper was produced with a slightly different version of the program. Moreover, I had not taken care, at the time, of saving a \u02bbfrozen\u02bc version of the code with the parameters used for the figures of the paper. Rather, each program could be used either for producing a figure (for a conference poster, a talk or for the final paper), or for exploring the dynamics of the model. All parameters were therefore always subject to change, even after producing the figures of themodel. Looking back tomy code, I had to find the right version of the program that was able to produce a given figure, and then to find the appropriate parameter set that reproduces the simulation displayed in the paper. And the number of parameters of the model, although not so high for a network model, is still too large to be fully explored manually: The network includes six inde-\nReScience C 6.1 \u2013 Leblois 2020 4\npendent connection weights and 8 inputs that were changed between simulations, and as many synaptic time constants and delays. It is thus virtually impossible to find the exact parameter set that was used in a figure of the paper if it wasn\u02bct saved somewhere. And it wasn\u02bct saved for most figures. Rather than depending on my capacity to save and store all parameter values for all figures produced on a long timescale, my capacity to reproduce the results of the paper instead relied on our global understanding of the dynamics of the network. As stated above, the dynamics of the network was first determined analytically, and the critical parameters influencing the general dynamics of themodel were known from this analytical study. Exploring the network dynamics through numerical simulation was greatly guided by this knowledge. 15 years later, I still have this global understanding of the model (and anyone could get it by reading the paper and doing the maths) and I know which parameter I have to change to get the expected behaviour. I was thus able to reproduce the results of the paper by producing a set of figures (see Figs. 3, 4, 5) identical or similar to the figures of the original paper sometimes, the parameter set used for the new figure is slightly different from the original one, leading to slightly different level of spontaneous or movement-related activity in some of the populations of the model. However, the qualitative behaviour of the model is the same in the new figures as in the original paper, and all specific result described in the original paper was retrieved. In particular, all the dynamical regimes described in the original paper can be illustrated by a specific figure, as detailed below. In the reduced model, I have successfully reproduced all dynamical regimes described in the original paper. As summarized in Fig. 3A-B, the network can be set in the unstable fixed point and the instability (A: symmetry breaking instability, B: oscillatory instability) triggered by an infinitesimal asymmetric input (as in Figure 3 of the original paper). Moreover, when monitoring the response of the network to a weakly and transiently selective external input, the responses of the network in the various dynamical regimens (Fig. 3C-F) recapitulates the various responses depicted in the original paper (original Figure 5). In particular, selection of one motor program can be efficient (only one cortical population activated) in the \u02bbphysiological\u02bc regimen of symmetry breaking (Fig. 3C) and even persistent in the multi-stability regimen (Fig. 3F), while both cortical populations are activated in other regimens (Fig. 3D-E), with oscillations appearing when the direct pathway is sufficiently week (Fig. 3E). Again, I want to emphasize here\nReScience C 6.1 \u2013 Leblois 2020 5\nthat the original paper, instead of describing the behaviour of the model for specific parameter sets, provided a full description of all dynamical regimens available to the network in the range of G+ and G- provided in the phase diagram figure (0<G<3 for each gain). Therefore, while specific figures in the original paper are produced with a given parameter set, reproducing the original results does not rely on our ability to reproduce exactly the same activity patterns with the exact same parameter sets. Rather, reproduction of the results consists in reproducing the behaviour of the network in all dynamical regimens described originally, and finding the important parameters that induce a transition from one regimen to another (the order parameters that underlie the bifurcation, to use to the proper words from the physics of non-linear system dynamics). In our case, varying the gain of the direct loop (G+) step-by-step while keeping other parameters stable is sufficient to illustrate all possible regimens of the model network (Fig. 3). However, this illustrates properly the dynamics of the network only if external inputs and other synaptic gains in the network are properly set such that all neural populations of the network are activated. Otherwise, when at least one population is below threshold, the feedback loops do not operate anymore and the dynamics of the network is \u02bbopenloop,\u0313 as in the resting state of the reduced model (time from -500ms to 0 in Fig. 3C-F). Altogether, knowing the dynamics of the network, parameters can be easily twitched to reach all available dynamical regimens of the model network to reproduce the original results. In the detailed model, I also reproduced all results from the original paper. In the presence of synaptic noise and neuronal heterogeneities, an important property of the detailed model is to display a symmetric resting state with activity above the threshold in all neuronal populations of the network (as described in Figure 6 of the original paper). The crucial ingredient that allows a stable symmetric resting state is the lower effective gain of striatal neurons as the population of striatal neurons operate in a low firing regime driven by noise. In this regime, neurons are close to their firing threshold and the effective gain of the population increases with the average input received by striatal neurons. It is therefore crucial that the average activity of striatal neurons is widely distributed (Fig. 4A), due to a widely distributed firing threshold in the striatal population. The wide distribution of activity level is present in all populations of the network (e.g. the GPi, Fig. 4B), and all neuronal populations of the network display average firing rates above zero (Fig. 4C). Finally, we reproduced in the detailed model the capacity of the network to select an action (Fig. 5A-B, physiological regimen), the loss of action selection properties for mild dopaminedepletion (Fig. 5C) and the emergence of oscillations following strongdopamine depletion (Fig. 5D). The ability of the network to display a strong selective response, even after strong dopamine depletion, is also illustrated by the response of the network to a strong selective input applied to the cortex (Fig. 5E)."}, {"heading": "Conclusion", "text": "Altogether, reproducing my own work was an interesting and very instructive experience. The great stability of the C-code compilers and function made this replication easy as my 15-year old programs were still running without any correction to be made. Concerning the figures created with Matlab, the code was also usable under a more recent version of the software, and only very small changes had to be done to reiterate the figures. However, I realized what made my previous study sometimes difficult to reproduce as presented because I had not saved each single parameter set used for each figure. Was that problematic? Not really, because I also realized that guiding numerical simulation of a model network with an analytical understanding of the network dynamics is crucial. It provides a global understanding of the network dynamics that guides the numerical exploration both during the initial study and when going through the replication. My personal archives were not perfectly organized, and in particular\nReScience C 6.1 \u2013 Leblois 2020 6\nReScience C 6.1 \u2013 Leblois 2020 7\nI did not save the parameter sets used for each figure of the paper. Still, I was able to reproduce the general behaviour of the network model described in the original paper and produce qualitatively showing the same results and quantitatively very close to the original figure, proving the same point initially argued in the paper. Therefore, I believe that a non-informed person reading the original paper could use the same guidance, as long as (s)he can do the maths underlying the analysis of non-linear dynamical system represented by themodel network. Replicating the results of the paper in this case does notmerelymean running publicly available code to reproduce a given set of figures, but rather to understand the dynamics of the system composed of the BG-thalamo-cortical network represented in our model and its rich dynamics."}], "title": "[Re] Reproduction of the normal and pathological dynamics in the basal ganglia-thalamo-cortical network", "year": 2021}