{"abstractText": "DOI 10.5281/zenodo.6801765 Abstract Studies in the field of synthetic biology are constantly making additions to biological circuit repositories, as well as to the theoretical understanding of their capabilities. The ability to compute with biomolecules has been demonstrated by many synthetic gene networks, but until recently the majority of such models were engineered to implement the functionality of a single circuit part. Purcell et al. have proposed a network capable of multiple functions, switching between three different behaviours in a programmable fashion. This work provides an open-source implementation in which their in silico experiments were replicated.", "authors": [{"affiliations": [], "name": "Gabriel Baiocchi de Sant\u2019Anna"}, {"affiliations": [], "name": "Mateus Favarin Costa"}, {"affiliations": [], "name": "Konrad Hinsen"}, {"affiliations": [], "name": "Aaron Shifman"}], "id": "SP:a2df309e19645a5c9640cb9b3efad68e8dc69f47", "references": [{"authors": ["D.E. Cameron", "C.J. Bashor", "J.J. Collins"], "title": "A brief history of synthetic biology.", "venue": "Nature Reviews Microbiology", "year": 2014}, {"authors": ["A. Goni-Moreno", "M. Amos"], "title": "A reconfigurable NAND/NOR genetic logic gate.", "venue": "BMC Systems Biology", "year": 2012}, {"authors": ["S.A. Salehi", "H. Jiang", "M.D. Riedel", "K.K. Parhi"], "title": "Molecular Sensing and Computing Systems.", "venue": "IEEE Transactions on Molecular, Biological and Multi-Scale Communications", "year": 2015}, {"authors": ["M.B. Elowitz", "S. Leibler"], "title": "A synthetic oscillatory network of transcriptional regulators.", "venue": "Nature", "year": 2000}, {"authors": ["C. Lin", "T. Kuo", "Y. Chen"], "title": "Implementation of a genetic logic circuit: bio-register.", "venue": "In: Systems and Synthetic Biology", "year": 2015}, {"authors": ["L. Cardelli", "M. Kwiatkowska", "M. Whitby"], "title": "Chemical reaction network designs for asynchronous logic circuits.", "venue": "Natural Computing", "year": 2018}, {"authors": ["G.H. Moe-Behrens"], "title": "The Biological Microprocessor, or How to Build a Computer with Biological Parts.", "venue": "Computational and Structural Biotechnology Journal", "year": 2013}, {"authors": ["T. Mahajan", "K. Rai"], "title": "A novel optogenetically tunable frequency modulating oscillator.", "venue": "PLOS ONE 13.2 (Feb", "year": 2018}, {"authors": ["A. Khalil", "J. Collins"], "title": "Synthetic Biology: Applications Come of Age.", "venue": "Nature reviews. Genetics", "year": 2010}, {"authors": ["C. Lin", "P. Chen", "Y. Cheng"], "title": "Synthesising gene clock with toggle switch and oscillator.", "venue": "IET Systems Biology", "year": 2015}, {"authors": ["O. Purcell", "M. di Bernardo", "C.S. Grierson", "N.J. Savery"], "title": "A Multi-Functional Synthetic Gene Network: A Frequency Multiplier, Oscillator and Switch.", "venue": "PLOS ONE 6.2 (Feb", "year": 2011}, {"authors": ["T.R. Kuphaldt. Lessons In Electric Circuits"], "title": "Volume VI - Experiments", "venue": "URL: https://www.ibiblio.org/kuphaldt/ electricCircuits/Exper/EXP_8.html", "year": 2019}, {"authors": ["P. B"], "title": "Ingalls.Mathematical Modeling in Systems Biology: An Introduction", "year": 2013}, {"authors": ["URL Octave Forge Community. Octave randn Documentation."], "title": "https : / / octave", "venue": "sourceforge . io / octave / function/randn.html", "year": 2019}], "sections": [{"text": "Edited by Konrad Hinsen ID\nReviewed by Aaron Shifman ID Konrad Hinsen ID\nReceived 15 January 2020\nPublished 06 July 2022\nDOI 10.5281/zenodo.6801765\n1 Introduction\nThe field of biomolecular computing \u2013 and DNA\u2010based computing in particular \u2013 has advanced remarkably over the last years [1]. There are numerous designs of biological parts which implement the behavior of digital logic gates [2], continuous\u2010time systems [3], oscillators [4], memory components [5], asynchronous circuits [6] and so on. Such re\u2010 cent developments allow one to consider the possibility of exploting biologically derived materials and their aspects of massive parallelism and self\u2010replication to build practical computing systems on biological substrata [7].\nAmidst forward\u2010engineered biochemical systems, genetic oscillators have been a fo\u2010 cus of research [8] as they are required for the correct operation of synchronous sequen\u2010 tial circuits and can also provide persistent periodic stimuli to other regulatory networks which may rely on them [9]. Genetic switches present another functionality specially useful [9] to digital logic: the ability to toggle between on or off states by either acti\u2010 vating or repressing the expression of a certain gene makes them equivalent to a cellu\u2010 lar memory unit [7]. One study has shown that combining an oscillator with a toggle switch under certain circumstances will result in the generation of a clock\u2010like near square wave signal [10]. Until recently, though, there was no genetic network capable of exhibiting both of these behaviours and alternating between them.\nPurcell et al.11 presented the in silico design of a novel genetic regulatory network which performs frequency division on an oscillating input. During experiments, that model was also discovered able to behave as a self\u2010induced oscillator or toggle switch \u2013 thus ressembling the most successful electronic Integrated Circuit (IC) ever devel\u2010 oped, the 555 timer IC [12]. We believe such multi\u2010functionality may lead to more pro\u2010 grammable and reusable components in biological computing.\nIn this work, we develop an open\u2010source implementation of their multi\u2010functional synthetic gene network in order to reproduce the original simulations and verify the simplifying assumptions used in the equations which model their genetic circuit.\nCopyright \u00a9 2022 G.B.D. Sant\u2019Anna and M.F. Costa, released under a Creative Commons Attribution 4.0 International license. Correspondence should be addressed to Gabriel Baiocchi de Sant\u2019Anna (baiocchi.gabriel@gmail.com) The authors have declared that no competing interests exists. Code is available at https://github.com/baioc/re-multif \u2013 DOI 10.5281/zenodo.3545451. Open peer review is available at https://github.com/ReScience/submissions/issues/13.\nReScience C 8.1 (#5) \u2013 Sant\u2019Anna and Costa 2022 1\n2 Methods\nThe multi\u2010functional synthetic gene network and its dynamics are wholly described in the original study. Supplementary material (\u201cFile S1\u201d, in [11]) contains the complete Or\u2010 dinary Differential Equation (ODE) system that models the genetic circuit under mass\u2010 action kinetics. The Quasi\u2010Steady\u2010State Assumption (QSSA) exploited to derive the re\u2010 duced model is also provided, together with all reaction parameterization and initial state of each experiment. These factors allowed for an easy replication of the model, evenwithout direct reference to source code or anyusage of the proprietary tools (MAPLE and MATLAB) originally employed.\nThe QSSA equations defining the reduced model are given below, where [\u00b7] denotes protein concentration. Here, h+ and h\u2212 represent activating and repressing Hill func\u2010 tions with Hill coefficient N and half\u2010saturation concentration kA. Additional network constants include protein translation rate ktl; maximum and unrepressed transcription rates \u03b2 and Ptc; and degradation rates for mRNA (\u03b4m) and repressor proteins (\u03b4x). Thus, we borrow the network\u2019s mathematical description from the original paper to replicate each of the hereby presented experiments. Unless otherwise stated, experimental re\u2010 sults on the next section have protein concentrations initially set to R1 = R2 = 50nM , R3 = R4 = 0nM and reaction parameters are the same as given in the reference work.\n\u02d9[R1] = \u03b1h+([I])h\u2212([R2]) + \u03b3h\u2212([R3])\u2212 \u03b4x[R1] \u02d9[R2] = \u03b1h+([I])h\u2212([R4]) + \u03b3h\u2212([R3])h\u2212([R4])\u2212 \u03b4x[R2] \u02d9[R3] = \u03b1h+([I])h\u2212([R4]) + \u03b3h\u2212([R1])\u2212 \u03b4x[R3] \u02d9[R4] = \u03b1h+([I])h\u2212([R2]) + \u03b3h\u2212([R1])h\u2212([R2])\u2212 \u03b4x[R4]\nh+([X]) = [X]N\nkNA + [X] N\nh\u2212([X]) = 1\n1 + [X] N\nkNA\n\u03b1 = ktl\u03b2\n\u03b4m\n\u03b3 = ktlPtc \u03b4m\nAll numerical simulations were performed in Octave 5.2.0, with additional packages signal-1.4.1 andcontrol-3.2.0. Weused two integrationmethods throughout: a hand\u2010written Euler\u2019s method implementationwith a step size of 60 seconds and Octave\u2019s Dormand\u2010Princemethod ode45, both yielding similar results on all of our experiments. This differs from the MATLAB solvers \u2013 ode45 for the deterministic simulations and ode4 for the stochastic ones \u2013 used by Purcell et al.11, but Euler\u2019s method is justified by the duration of experiments, the shortest of which take at least four days (virtual simulated time) in order to observe a couple of periods on the oscillating output of the frequency divider. Due to this difference, some numerical mismatch is to be expected, while qualitative behaviour should remain the same.\nEvery deterministic experiment was carried in two systems: one considering the whole set of ODEs and another with the QSSA approximation that is used throughout the original study. Quantitative results shown refer to the full model and deviations between that and the reduced one are highlighted in the text. While stochastic sim\u2010 ulations are only briefly mentioned in the reference work, more details can be found inside supporting information documents (\u201cFile S6\u201d, in [11]). The Chemical Langevin Equations (CLEs) described therein were implemented with Gaussian noise being gen\u2010 erated through the use of built\u2010in Octave functions.\nReScience C 8.1 (#5) \u2013 Sant\u2019Anna and Costa 2022 2\n3 Results\n3.1 Frequency Divider The networkwas originally designed as a frequency divider such that the concentrations of repressor proteins oscillate in approximately one half of the input frequency. This behaviour can be observed by feeding the model with a continuously oscillating input \u2013 this would be often the case considering existing genetic oscillators [8] \u2013 but also works with square waves (Figure 1).\nReScience C 8.1 (#5) \u2013 Sant\u2019Anna and Costa 2022 3\nWith a sinusoidal input, output signals from the QSSA model have constant ampli\u2010 tude, whereas in the full model the first concentration peak of proteins R2 and R3 are higher than the following ones. This suggests mRNA reactions stabilize quicker in the first 105 seconds and thus the approximation is more accurate at those instants [13]. Af\u2010 ter that moment, however, the reduced model exhibits a persistent offset in relation to the full one.\nAs illustrated in Figures 2a and 2b, while R1 and R4 concentrations in the full model reach maxima valued at 238.29 nM and 87.62 nM respectively, the reduced model goes up to 283.96 nM and 113.05 nM for each of these proteins (peak values of R3 follow R1 closely and the samehappenswith R2 andR4). This offset distinguishing the twomodels happens because the QSSA used to derive the reduced ODE system considers a separa\u2010 tion of time\u2010scales between reactionswhich regulatemRNAproduction and thosewhich describe protein translation. In the approximation, the former reactions are assumed to reach equilibrium instantaneously relative to the latter. Thus, the difference comes from the fact that the original model maintains itself in a dynamic state that never actu\u2010 ally reaches equilibrium [13], as it perpetually oscillates.\nAs mentioned in the original study, frequency division functionality can only be ob\u2010 served after a specific period threshold. We ran experiments over a range of input fre\u2010 quencies and found the period\u2010doubling bifurcation to be located near values of 0.8\u00d7105 seconds (\u223c 22 hours) in both full and reduced models. Although this confirms the net\u2010 work\u2019s capability to interface with long\u2010period oscillators, these results \u2013 shown in Fig\u2010 ure 3 \u2013 greatly diverge from those in the referencework, which state this threshold could be observed at input periods of approximately 0.275\u00d7 105 seconds (\u223c 8 hours). We note that varying the integration time step between 1 and 60 seconds had little to no effect on the location of the period\u2010doubling bifurcation and neitheir did changing the inte\u2010 gration method: the ode45 solver yields the same results.\nReScience C 8.1 (#5) \u2013 Sant\u2019Anna and Costa 2022 4\n3.2 Bifurcation Analysis\nPurcell et al.11 discovered the model\u2019s multiple extra functionalities by verifying differ\u2010 ent behaviours could be attainedwhen input concentrationwas held constant at specific ranges. Experiments regarding the so\u2010called bifurcation analysis were reproduced and\nFigures 4\u20107 show results under the full model. These correspond to the simulation pan\u2010 els displayed within Figure 5 in the reference paper.\nThe original study states experiments labeled 4c1 and 1b use the same initial condi\u2010 tions as 4c2 and 1a respectively. We believe these were typographical errors, as such settings would lead those pairs of experiments to the exact same results under deter\u2010 ministic semantics and this is not the exhibited behaviour. Instead, whereas reaction parameters and input levels are the same as in the original work, initial conditions used are R1 = R2 = 0nM and R3 = R4 = 50nM for experiments 1b and 4c2 and R1 = R2 = 50nM and R3 = R4 = 0nM for all others.\nReScience C 8.1 (#5) \u2013 Sant\u2019Anna and Costa 2022 5\n3.3 Self-induced Oscillator We verified the network\u2019s oscillatory dynamics in the region between saddle\u2010node and Hopf bifurcations by measuring its output period for each given input concentration level. Results illustrated in our Figure 8 describe a relation with similar behaviour and the same near\u2010vertical increase in period when input approaches the lower bistability region as Figure 6A in the original paper.\n3.4 Toggle Switch As revealed during bifurcation analysis, the network exhibits bistability when input con\u2010 centration is held outside the oscillatory range, that is, at levels lower than 0.4 nM or greater than 7nM. Figure 9 illustrates the system being used as a toggle switch which is \u201ctriggered\u201d by varying binding affinity of particular repressors, altering kA momentarily\nReScience C 8.1 (#5) \u2013 Sant\u2019Anna and Costa 2022 6\nfrom 6\u00d7 10\u221210M to 4\u00d7 10\u22126M , as described in the reference work. It is important to note that this behaviour can be observed even when the simulated system does not start from \u201cclean\u201d (i.e. unused) state. This means the switch can be toggled on and off repeatedly (not shown), which is to be expected in any non\u2010trivial synthetic biology application [2].\n3.5 Stochastic Simulations We implemented the CLEs shown in the related supporting information document (\u201cFile S6\u201d) provided by Purcell et al.11, but it was not possible to verify similar results without modifications to the noise\u2010inducing function. The reference work states the usage of Gaussian noise with zero mean and variance of 1, but employing Octave\u2019s randn func\u2010 tion (which provides such a distribution [14]) proved being too noisy, as stochastic fluc\u2010 tuations began dominating the model\u2019s behaviour.\nThis phenomenon was reproduced using both the fixed\u2010step Euler method and the adaptive ode45 integrator. We are led to believe this is due to the usage of standard ODE solvers (instead of a more appropriate stochastic method), which have the effect of increasing noise variance based on the total number of simulated steps. In order to approximate the results in the reference work, random numbers are scaled by a factor \u2013 found empirically \u2013 s \u2208 [ 1100 , 1 10 ], consequently downscaling variance by s 2. Figures 10,\nReScience C 8.1 (#5) \u2013 Sant\u2019Anna and Costa 2022 7\n11 and 12 show some stochastic simulations with this compensation factor applied.\nWe verified that among the three functionalities, frequency division appears less ro\u2010 bust to intrinsic noise: when input is applied and proteins are all at low concentrations, random fluctuations may cause unintended oscillations as a pair of repressors rise in concentration and prevent transcription of the other two. An example of such irregular oscillations is given in Figure 12, in which we use a specific pairing of random seed and scaling factor to illustrate this behaviour.\nReScience C 8.1 (#5) \u2013 Sant\u2019Anna and Costa 2022 8\n4 Conclusions\nAll operation configurations in the multi\u2010functional synthetic gene network were ver\u2010 ified and to a large degree the results presented in [11] were replicated. It should be emphasised that the original work stands as an example of reproducible science, with detailed descriptions of model derivation, parameter decisions and additional exper\u2010 iments in openly available supplementary material. The QSSA simplification proved being a good approximation of the full ODE system, since even though some small quan\u2010 titative differences were observed \u2013 and those could be due to the different integration methods as well \u2013 there was no impact on the network\u2019s overall dynamics.\nHowever, stochastic simulations would not provide the expected results without an expressive reduction to noise variance. In fact, Gaussian noise seems capable of un\u2010 dermining frequency division functionality to some degree. Additionally, the period\u2010 doubling bifurcation was found at a much lower frequency than what is stated in the reference study. Upon correspondence with the authors, it was speculated that the displacement could have been caused by some mismatch between the parameters in the paper and those actually used in their simulation, since qualitative behaviour was mostly maintained and all other deterministic simulations match.\nWe highlight that, as synthetic networks grow in complexity and size, multiple func\u2010 tions may arise more frequently and even become difficult to avoid. While this could allow for reusable programmable components, it might also become a nuisance if mod\u2010 els start behaving unexpectedly under the influence of certain inputs. At last, we believe further extensions of this work could focus on a deeper exploration of parameter space. The motivation for this is double: it will allow for the design of in vivo implementations with reusable biological parts and may uncover the complete characterisation of this programmable genetic network, much like the datasheet of an electronic component."}], "title": "[Re] A Multi-Functional Synthetic Gene Network", "year": 2022}