{"abstractText": "Understanding markets is one of the major issues in game theory. It has implications in human economical markets [1, 2], as well as in biological markets [3, 4, 5, 6]. Search\u2010 and\u2010matching models have a very important place in the market literature. The general principle is as follows: individuals meet two by two and may decide to interact for a certain period of time and generate benefits. These models are widely used to try to predict a fundamental property of markets: who interacts with whom. This question is also called the matching problem. Historically, the search\u2010and\u2010matching literature is a merger of Becker\u2019s matching theory [7] and search theory [8, 9]. Shimer and Smith have written two seminal articles [10, 11] in this field, in which they (1) assume that individuals vary in their \u201ctype\u201d, i.e. their ability to generate benefits, and (2) study who interacts with whom when everyone plays the equilibrium strategy. More precisely, they derive the conditions for which more productive individuals types with other productive types. This situation is also called a Positive Assortative Matching (PAM). Both articles address this question, but differ in the way individuals exchange services. In Shimer and Smith\u2019s article [10], two individuals generate a benefit whose size depends on the two types and, then, they split the benefit. This case is called Transferable Utility (TU). Whereas in Smith\u2019s article [11], individuals directly receive a payoff that depends on both types without the possibility of sharing a common output. This case is called Non\u2010Transferable Utility (NTU). We decided to replicate results from both articles since the models are similar. The authors use game theory to derive the equilibrium, namely the optimal strategy that agents should adopt in amarket situation. However, the equilibrium is defined by three complex equations for which it is not possible to obtain a closed\u2010form solution. The au\u2010 thors use an algorithm to findnumerical solutionswhich is derived from the proof of the existence of an equilibrium (discussed in [12]). We contacted the authors and had access", "authors": [{"affiliations": [], "name": "F\u00e9lix Geoffroy"}, {"affiliations": [], "name": "Nicolas P. Rougier"}, {"affiliations": [], "name": "Dirk Eddelbuettel"}, {"affiliations": [], "name": "Aur\u00e9lien Nioche"}], "id": "SP:ccb0e61c664d2e87f13468d3e5c65bce943b533c", "references": [{"authors": ["M.J. Osborne", "A. Rubinstein"], "title": "Bargaining and markets", "venue": "Academic press,", "year": 1990}, {"authors": ["H. Chade", "J. Eeckhout", "L. Smith"], "title": "Sorting through Search and Matching Models in Economics.", "venue": "en. In: Journal of Economic Literature", "year": 2017}, {"authors": ["R. No\u00eb", "P. Hammerstein"], "title": "Biological markets.", "venue": "Trends in Ecology & Evolution", "year": 1995}, {"authors": ["P. Hammerstein", "R. No\u00eb"], "title": "Biological trade andmarkets.", "venue": "en. In: Phil. Trans. R. Soc. B", "year": 2015}, {"authors": ["C. Fruteau", "B. Voelkl", "E. v. Damme", "R. No\u00eb"], "title": "Supply and demand determine the market value of food providers in wild vervet monkeys.", "venue": "en. In: Proceedings of the National Academy of Sciences", "year": 2009}, {"authors": ["N. Baumard", "J.-B. Andr\u00e9", "D. Sperber"], "title": "A mutualistic approach to morality: The evolution of fairness by partner choice.", "venue": "en. In: Behavioral and Brain Sciences", "year": 2013}, {"authors": ["G.S. Becker"], "title": "A Theory of Marriage: Part I.", "venue": "Journal of Political Economy", "year": 1973}, {"authors": ["G.J. Stigler"], "title": "The economics of information.", "venue": "Journal of political economy", "year": 1961}, {"authors": ["R. Rogerson", "R. Shimer", "R. Wright"], "title": "Search-theoretic models of the labor market: A survey.", "venue": "Journal of economic literature", "year": 2005}, {"authors": ["R. Shimer", "L. Smith"], "title": "Assortative Matching and Search.", "venue": "en. In: Econometrica", "year": 2000}, {"authors": ["L. Smith"], "title": "The Marriage Model with Search Frictions.", "venue": "Journal of Political Economy", "year": 2006}, {"authors": ["L. Smith"], "title": "Frictional Matching Models.", "venue": "Annual Review of Economics", "year": 2011}, {"authors": ["M. Hagedorn", "T.H. Law", "I. Manovskii"], "title": "Identifying Equilibrium Models of Labor Market Sorting.", "venue": "en. In: Econometrica", "year": 2017}, {"authors": ["J. Lise", "C. Meghir", "J.-M. Robin"], "title": "Matching, sorting and wages.", "venue": "en. In: Review of Economic Dynamics. Special Issue in Honor of Dale Mortensen", "year": 2016}, {"authors": ["K.E. Atkinson"], "title": "An introduction to numerical analysis", "venue": "en. 2nd ed. New York: Wiley,", "year": 1989}, {"authors": ["L. Smith"], "title": "The Marriage Model with Search Frictions", "venue": "en. SSRN Scholarly Paper ID 34242", "year": 1997}], "sections": [{"text": "R E S C I E N C E C Replication / Game Theory\n[Re] Assortative matching and search\nF\u00e9lix Geoffroy1, ID 1Department of Evolutionary Theory, Max Planck Institute for Evolutionary Biology, August-Thienemann-Stra\u00dfe 2, 24306 Pl\u00f6n, Germany\nEdited by Nicolas P. Rougier ID\nReviewed by Dirk Eddelbuettel ID Aur\u00e9lien Nioche ID\nReceived 02 February 2021\nPublished 24 March 2021\nDOI 10.5281/zenodo.4646680\nA reference implementation of\n\u2192 Shimer, R., and Smith, L. (2000). Assortative matching and search. Econometrica, 68(2), 343\u2013369. http://doi.org/10.1111/1468-0262.00112\n\u2192 Smith, L. (2006). The Marriage Model with Search Frictions. J. Political Econ., 114(6), 1124\u20131144. https://doi.org/10.1086/510440"}, {"heading": "Introduction", "text": "Understanding markets is one of the major issues in game theory. It has implications in human economical markets [1, 2], as well as in biological markets [3, 4, 5, 6]. Search\u2010 and\u2010matching models have a very important place in the market literature. The general principle is as follows: individuals meet two by two and may decide to interact for a certain period of time and generate benefits. These models are widely used to try to predict a fundamental property of markets: who interacts with whom. This question is also called the matching problem. Historically, the search\u2010and\u2010matching literature is a merger of Becker\u2019s matching theory [7] and search theory [8, 9]. Shimer and Smith have written two seminal articles [10, 11] in this field, in which they (1) assume that individuals vary in their \u201ctype\u201d, i.e. their ability to generate benefits, and (2) study who interacts with whom when everyone plays the equilibrium strategy. More precisely, they derive the conditions for which more productive individuals types with other productive types. This situation is also called a Positive Assortative Matching (PAM). Both articles address this question, but differ in the way individuals exchange services. In Shimer and Smith\u2019s article [10], two individuals generate a benefit whose size depends on the two types and, then, they split the benefit. This case is called Transferable Utility (TU). Whereas in Smith\u2019s article [11], individuals directly receive a payoff that depends on both types without the possibility of sharing a common output. This case is called Non\u2010Transferable Utility (NTU). We decided to replicate results from both articles since the models are similar. The authors use game theory to derive the equilibrium, namely the optimal strategy that agents should adopt in amarket situation. However, the equilibrium is defined by three complex equations for which it is not possible to obtain a closed\u2010form solution. The au\u2010 thors use an algorithm to findnumerical solutionswhich is derived from the proof of the existence of an equilibrium (discussed in [12]). We contacted the authors and had access\nCopyright \u00a9 2021 F. Geoffroy, released under a Creative Commons Attribution 4.0 International license. Correspondence should be addressed to F\u00e9lix Geoffroy (felix.geoffroy.fr@gmail.com) The authors have declared that no competing interests exists. Code is available at https://github.com/fgeoffroy/-Re-Assortative-matching-and-search. \u2013 SWH swh:1:dir:c4b7d774ab458f90c433e321ab969d3f12e410de. Open peer review is available at https://github.com/ReScience/submissions/issues/47.\nReScience C 7.1 (#2) \u2013 Geoffroy 2021 1\nto the code (Mathematica script) used for the first reference article [10]. Although the nu\u2010 merical solutions aremostly illustrative in the two reference articles, similar algorithms have been used in works which aim at fitting these models on economical markets data [13, 14]. This is why we think it is important to replicate the results and have an openly available version of this algorithm for the scientific community. We are able to replicate all figures from both papers, except for one, which is discussed in Results."}, {"heading": "Methods", "text": ""}, {"heading": "Model description", "text": "We start by describing the search\u2010and\u2010matching model proposed in the first reference article [10]. In a population of arbitrary size, each individual is defined by a type x \u2208 [0, 1]. The continuous distribution of types is given by the density function l. At any time, an individual is either matched with a partner, or unmatched. An unmatched individual encounters another one at rate \u03c1, and a pair of matched individuals splits at rate \u03b4. The distribution of types for unmatched individuals is given by the unmatched density function u. In the first reference article [10], the utility is transferable (TU): a pair of individuals generates a benefit of size f(x, y) which is then split with a classic Nash bargaining pro\u2010 cedure [1, 10]. The benefit generated f(x, y) is an increasing function of both types x and y. Individuals discount time at rate r. Each individual must choose a strategy describing which types she is willing to accept as a partner. At the equilibrium, all individuals of the same type have the same strategy. We define the matching set function \u03b1 such that \u03b1(x, y) = 1 if individuals of type x accept individuals of type y as partners and if types y also accept types x. Otherwise, \u03b1(x, y) = 0. Solving the matching problem \u2013who interacts with whom\u2013 is equivalent to finding the equilibrium value of \u03b1. Lastly, it is convenient to introduce a function v which represents, for each type, her value, i.e. her expected lifetime payoff when she is in the unmatched state. The optimal strategy is then clear: an individual should accept a partner if the payoff she will get from this interaction is higher than her unmatched payoff. Shimer and Smith derive a system of three equations which defines a Nash equilibrium. For more details, see the proof in the article (sections 3 and 4 in [10]). u(x) = \u03b4l(x) \u03b4 + \u03c1 \u222b 1 0 \u03b1(x, y)u(y)dy \u2200x \u2208 [0, 1] v(x) = \u03b8 \u222b 1 0 (f(x, y)\u2212 v(x)\u2212 v(y))\u03b1(x, y)u(y)dy \u2200x \u2208 [0, 1] \u03b1(x, y) = { 1, if f(x, y) \u2265 v(x) + v(y) 0, otherwise \u2200x, y \u2208 [0, 1]2\nwith \u03b8 = \u03c12(r+\u03b4) . Unfortunately, it is not possible to derive a closed\u2010form analytical solution. The trick used by Shimer and Smith [10] to get a numerical approximation is to discretize the type space in n types. The problem can then be written in terms of vectors and matrices. Integrals can be approximated by Riemman sums if n is large enough.\nReScience C 7.1 (#2) \u2013 Geoffroy 2021 2\n ui = \u03b4li \u03b4 + \u03c1n n\u2211 j=1 \u03b1i,juj\n\u2200 1 \u2264 i \u2264 n\nvi = \u03b8\nn n\u2211 j=1 (fi,j \u2212 vi \u2212 vj)\u03b1i,juj \u2200 1 \u2264 i \u2264 n\n\u03b1i,j = { 1, if fi,j \u2265 vi + vj 0, otherwise\n\u2200 1 \u2264 i, j \u2264 n\nBecause we implement the algorithm with the Numpy library, it is convenient to write the system in matrix notation. We use the following notation for column vectors u = (ui)1\u2264i\u2264n and for square matricesA = (\u03b1i,j)1\u2264i\u2264n,1\u2264j\u2264n. u = \u03b4l \u03b4Jn,1 + \u03c1 nAu( Adiag(u) + In \u25e6 (n \u03b8 Jn +Au )) v = (F \u25e6A)u A = 1\n2\n( sgn ( F\u2212 vJ1,n \u2212 Jn,1v\u22a4 ) + Jn\n) (1) (2a)\n(3a)\nHere, the symbol \u25e6 denotes the Hadamard product (element\u2010wise product) and the frac\u2010 tion symbol is used in the sense of Hadamard division (element\u2010wise division). Ii is the identity matrix of size i and Ji,j is the all\u2010one matrix of dimensions i\u00d7 j (Ji denotes the square all\u2010one matrix of dimensions i\u00d7 i). In the second reference article [11], utility is non\u2010transferable (NTU): an individual in a pair receives a payoff f(x, y) which depends on her type x and her partner\u2019s type y. Accordingly, her partner receives a payoff f(y, x). The Nash equilibrium, in this case, is determined by u(x) = \u03b4l(x) \u03b4 + \u03c1 \u222b 1 0 \u03b1(x, y)u(y)dy \u2200x \u2208 [0, 1] v(x) = \u222b 1 0 f(x, y)\u03b1(x, y)u(y)dy \u03c8 + \u222b 1 0 \u03b1(x, y)u(y)dy \u2200x \u2208 [0, 1] \u03b1(x, y) = { 1, if f(x, y) \u2265 v(x) and f(x, y) \u2265 v(y) 0, otherwise \u2200x, y \u2208 [0, 1]2\nwith \u03c8 = r+\u03b4\u03c1 . We can also write these equations using matrix notation. The first equa\u2010 tion is the same as (1) and the other two are: v = (F \u25e6A)u n\u03c8Jn,1 +Au A = 1\n2 (sgn (F\u2212 vJ1,n) + Jn) \u25e6\n1\n2\n( sgn ( F\u2212 Jn,1v\u22a4 ) + Jn\n) (2b)\n(3b)"}, {"heading": "Implementation of the algorithm", "text": "The authors use an algorithm tofind the equilibriumnumerical values of theunmatched densities u, the values v and, most importantly, the matching set A. The algorithm is derived from the proof of the existence of an equilibrium (see [12] for details). Themain idea is to start with an initial guess for the matching setA, then, since one\u2019s probability of being unmatched depends on one\u2019s type and on the matching strategy of all players, we can update the unmatched densities u accordingly. From this, we can update the values of each type v and, finally, derive the new optimal matching strategy of each\nReScience C 7.1 (#2) \u2013 Geoffroy 2021 3\ntype A according to their values. This value adjustment process can be described by the following algorithm:\n0. Initialize (u,v,A)\n1. Update u by solving (1)\n2. Update v by solving (2a)\n3. UpdateA by solving (3a)\n4. IfA has been modified by Step 3, return to Step 1, else stop the loop.\nThe algorithm is the same for the NTU case, one should simply replace equation (2a) with (2b), and equation (3a) with (3b). Although there is no formal proof that this algorithm converges to the desired equilib\u2010 rium it does in practice in the majority of cases (L. Smith, personal communication). Moreover, if the algorithm converges, by definition, its solution is the desired Nash equilibrium. However, it can happen that the algorithm gets into an infinite loop. This comes from the fact that discretization into n types can lead to the existence of mixed strategies (see [13]) which we want to avoid here. Therefore, in Step 4 of the algorithm, we also check if the current value of A has already occurred, which would indicate an infinite loop."}, {"heading": "Solving the equations", "text": "Equation (1) is actually a system of nonlinear equations. We use a simple fixed\u2010point iteration to obtain a numerical solution with an accuracy of 10\u221212 (section 2.10 in [15]). In the algorithm used in the first reference article [10] communicated by the authors, the system is also solved with a fixed\u2010point iteration with an additional damping factor and the same accuracy. Shimer and Smith [10] also use a fixed\u2010point iteration for solving (2a). In our implemen\u2010 tation, we can take advantage of the fact that (2a) is a system of linear equations and can be written as Pv = q, with P = Adiag(u) + In \u25e6 ( n \u03b8 Jn +Au ) and q = (F \u25e6 A)u. The vector of values v is v = P\u22121q. Finally, equations (2b), (3a) and (3b) are straightforward to solve. The algorithm is implemented in Python."}, {"heading": "Results", "text": "Wewere able to replicate almost all results from both reference articles [10, 11]. Figures 1 and 2 replicate results from [10] (transferable utility) and Figure 3 replicates results from [11] (non\u2010transferable utility)."}, {"heading": "Shimer & Smith 2000", "text": "Figure 1 replicates Figure 1 from the first reference article [10]. It shows the matching set A at the equilibrium for several values of the number n of discrete types. As n in\u2010 creases, the discrete case converges to the continuous case. All further results (with one exception) are obtained with n = 500. Note that, in this case, the matching set is such that there is a Positive Assortative Matching (PAM, see Introduction): the minimum type that an individual is willing to accept as a partner is an increasing function of her type. In other words, individuals who are able to provide large benefits to their partners tend to interact with each other. Figure 2A, 2B and 2C respectively replicate Figure 3a, 3b and Figure 4 from [10]. Contrar\u2010 ily to the previous result, there is no Positive Assortative Matching at the equilibrium.\nReScience C 7.1 (#2) \u2013 Geoffroy 2021 4\nFigure 2B was obtained with n = 501 because an infinite loop occurs for n = 500. Note that, with the same parameters, the algorithm also fails to converge when we run the Mathematica script that the authors have provided. Lastly, Figure 2D replicates an extra figure not present in the first reference article [10], but in [12] (Figure 4 in [12]). We have decided to include it to increase the confidence in the robustness of our implementa\u2010 tion.\nSmith 2006 Figure 3A and 3B are two attempts at replicating Figure 1 from the second reference article [11]. When we run our algorithm with the parameters provided in the figure caption in [11], replication fails (Fig. 3A). By comparing Figure 3A and Figure 1 from [11], one can see that the resulting matching sets are qualitatively different. We do not have access to the code which has been used in this article because it has been lost (L. Smith, personal communication). Thus, it is not possible to knowwhere the discrepancy between the results comes from. Nevertheless, we would like propose an explanation for this discrepancy. Please note that this is entirely speculative, since there is no way to run the exact algorithm used in [11]. The caption of Figure 1 in [11] specifies that the author used \u201c\u03b4 = .1\u201d, which usually means \u201c0.1\u201d. Still, this notation is not used for the parameter \u201cr = 0.3\u201d. We think that there might be a typo in \u201c\u03b4 = .1\u201da. We run the algorithm for \u03b4 = 1.1 and the resulting figure (Fig. 3B) seems to replicate Figure 1 from [11]. In Figure 3C, were able to replicate Figure 2 of [11]. However, in [11], the caption below Figure 2 states that \u201cthe parameters in fig. 1 are assumed, except \u03c1 = 3\u201d. We therefore use \u03b4 = 0.1, which leads to a good replicate of Figure 2 from [11]. Changing \u03b4 to 1.1, as we did for the previous figure, leads to a replication failure (Figure 3D)."}, {"heading": "Gaussian distribution", "text": "In both reference articles, the distribution of types is always assumed to be uniform, i.e. \u2200x \u2208 [0, 1] : l(x) = 1. This is not necessarily the case in real\u2010life applications of search\u2010and\u2010matching models (see [13]). In Figure 4, we show an example of matching sets at the equilibrium for the Uransferable Utility case with a Gaussian distribution of types. There is no replication purpose for this result, but we think it might be useful to include it given the importance of this assumption. In particular, because the standard deviation of the distribution determines the availability of extreme types, it has a crucial impact on the matching set at the equilibrium, i.e. \u201cwho interacts with whom.\u201d Individ\u2010 uals can only afford to be picky aout their partners\u2019 type when high type individuals are available in the population (Fig. 4)."}, {"heading": "Conclusion", "text": "All the figures in the first reference article [10] have been successfully replicated (Fig. 1 and 2). Only one of the two figures in the second article [11] has been replicated (Fig. 3A and 3B). We have explored the possibility that our replication failure comes from an er\u2010 ror in a parameter value given in a figure caption, yet, this is really uncertain, given that the same parameter value leads to a replication success for the second figure (Fig. 3C). We are unable to provide a clear explanation for this, since the code has been lost. This shows how important the archiving and replicating processes are, even for computa\u2010 tional works. Finally, we have extended the algorithm to include additional assump\u2010 tions about the distribution of types (Fig. 4) to match the current use of this algorithm\naNote that a slightly different version of the second reference article [11] was previously published in the Social Science Research Network in 1997 [16]. However, the parameter values given in the figure caption are identical.\nReScience C 7.1 (#2) \u2013 Geoffroy 2021 5\nin the search\u2010and\u2010matching literature. We hope this replication can help clarify the method used in two papers of great importance, and that it can promote future research in the domain."}, {"heading": "Acknowledgements", "text": "We would like to thank Robert Shimer and Lones Smith for providing the script of one of the articles, and for useful information. We also thank Dirk Eddelbuettel who reviewed this article and provided an R script for performing a visual comparison between the output of the Python script and the figures in this article.\nReScience C 7.1 (#2) \u2013 Geoffroy 2021 6\nReScience C 7.1 (#2) \u2013 Geoffroy 2021 7\nReScience C 7.1 (#2) \u2013 Geoffroy 2021 8\nReScience C 7.1 (#2) \u2013 Geoffroy 2021 9"}], "title": "[Re] Assortative matching and search", "year": 2021}